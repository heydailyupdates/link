<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Link in Bio | AV Tutorial</title>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
    rel="stylesheet"
  />

  <!-- Main CSS -->
  <link rel="stylesheet" href="assets/style.css" />
</head>

<body>
  <main class="page">
    <section class="card">
      <div class="hero">
        <div id="logo" class="logo-circle">AV</div>

        <h1 id="title">AV Tutorial</h1>
        <div id="subtitle" class="subtitle">AV Tutorial</div>

        <ul id="bullets" class="bullets"></ul>

        <!-- SOCIAL IMAGE ICONS -->
        <div class="socials" id="socials"></div>
      </div>

      <div id="actions" class="actions"></div>
    </section>
  </main>

  <!-- MAIN SCRIPT -->
  <script>
    const dataUrl = 'content/data.json';

    function setLogo(profile) {
      const logoEl = document.getElementById('logo');

      if (profile.logo) {
        const img = document.createElement('img');
        img.src = profile.logo;
        img.alt = profile.name || 'Logo';
        logoEl.innerHTML = '';
        logoEl.classList.add('logo-image');
        logoEl.appendChild(img);
      } else {
        logoEl.textContent = (profile.name || 'AV')
          .substring(0, 2)
          .toUpperCase();
      }
    }

    function renderBullets(bullets = []) {
      const list = document.getElementById('bullets');
      list.innerHTML = '';

      bullets.forEach(item => {
        const li = document.createElement('li');
        li.innerHTML = `
          <span class="emoji">${item.emoji || '•'}</span>
          <span>${item.text || ''}</span>
        `;
        list.appendChild(li);
      });
    }

    /* ✅ SOCIAL ICONS AS IMAGES (CLICKABLE) */
    function renderSocials(social = {}) {
      const container = document.getElementById('socials');
      container.innerHTML = '';

      const items = [
        { url: social.instagram, img: social.instagram_image, alt: 'Instagram' },
        { url: social.whatsapp,  img: social.whatsapp_image,  alt: 'WhatsApp' },
        { url: social.facebook,  img: social.facebook_image,  alt: 'Facebook' },
        { url: social.youtube,   img: social.youtube_image,   alt: 'YouTube' }
      ];

      items.forEach(item => {
        if (!item.url || !item.img) return;

        const link = document.createElement('a');
        link.href = item.url;
        link.target = '_blank';
        link.rel = 'noopener noreferrer';
        link.className = 'social-icon';

        const img = document.createElement('img');
        img.src = item.img;
        img.alt = item.alt;

        link.appendChild(img);
        container.appendChild(link);
      });
    }

    function renderActions(actions = []) {
      const container = document.getElementById('actions');
      container.innerHTML = '';

      actions.forEach(action => {
        if (!action.label) return;

        const btn = document.createElement('a');
        btn.className = 'cta';
        btn.href = action.url;
        btn.target = '_blank';
        btn.rel = 'noopener noreferrer';
        btn.textContent = action.label;

        container.appendChild(btn);
      });
    }

    async function loadData() {
      try {
        const res = await fetch(dataUrl);
        if (!res.ok) throw new Error('Failed to load data');
        const data = await res.json();

        document.getElementById('title').textContent =
          data.profile?.name || 'Profile';

        document.getElementById('subtitle').textContent =
          data.profile?.tagline || '';

        setLogo(data.profile || {});
        renderBullets(data.profile?.bullets || []);
        renderSocials(data.social || {});
        renderActions(data.actions || []);
      } catch (e) {
        console.error(e);
      }
    }

    loadData();
  </script>

  <!-- NETLIFY IDENTITY -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <script>
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on("login", () => {
        document.location.href = "/admin/";
      });
    }
  </script>
</body>
</html>
